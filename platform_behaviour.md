在疫情或经济遭受冲击时，以什么方式应对冲击，这永远是摆在人类面前的问题。
platform Behavior under Market Shocks: A Simulation Framework and Reinforcement-Learning Based Study 给出了从AI视角来看待对经济体系干预的办法，以及给出了经济平台应对冲击时可行的方法。

文章研究了经济平台（例如亚马逊、Uber Eats、Instacart）在冲击（例如COVID-19封锁）下的行为，以及不同监管考虑因素的影响。文章主要提出了：<br>
（1）作者开发了一个多期设置的平台经济多代理模拟环境，其中可能发生冲击并扰乱经济。并考虑两种主要类型的监管框架：税收政策和平台费用限制。 <br>
（2）文章的实验结果表明，虽然许多干预措施对于一个复杂的平台是无效的，但作者提出了一种RL平台匹配算法，保持与在没有经济冲击的情况下选择的费用结构相同，同时允许平台根据冲击调整其匹配政策，有望促进经济系统的效率和韧性。<br>

## 1.决策模型
### 1.1 市场环境以及交易规则： 

市场由买家B、卖家S和单一平台p组成。 在特征空间中， $v_b,v_s\subseteq[0,1]$ 分别表示了卖家和买家的信息。 
第一个维度是商品种类，拿食物举例就是，意大利菜，日本菜等， 第二个维度则是价格水平，商家售出的价格， $v_s$， 在 $\omega_s$的成本下。
每个买家知道一部分的卖家，可以在不经过平台的情况下，同这部分卖家进行现实交易。
现实交易系数µk>0,表示在真实世界的交易成本(不使用平台)。

**每个epoch k的开始：<br>**
平台设置买家和卖家的订阅费用 $P_{B,k}\ge0,P_{S,k}\ge0$ 和推荐费 $P_{R,k}\subseteq[0,1]$,推荐费代表在一单交易中，卖方承担的交易费比例。
买家和卖家是可以观察到平台订阅费用和现实交易系数 $\mu_k\gt0$， 也就是线下交易的成本，决定是否订阅付费使用平台。
对于买家有一个预算限制 $psi_b\gt0$，这个预算与买方的偏好价格 $v_b^1$正相关，用于限制每个epoch中单个买家的交易上限。

**对于每个epoch中的每个时间节点t：<br>**
(1) 买家发出查询(Query),包含食物种类以及偏好价格。
(2) 平台进行匹配(Match)，平台寻找线上商家中匹配的商家。
(3) 进行交易(Transaction)。买家在自己已知的线下商家 $S_b$ 和平台匹配的商家 $s_{p.t}$中选择更省钱的选项。

**在每个epoch k结束时：<br>**
买家和卖家评估其交易费用（是否给自身带来盈余，下节会讲到，简单理解就是是否比线下交易更省钱）， 决策未来是否订阅。平台评估所获得的收入，以调整费用或匹配策略。
每个卖家都有一个关闭门槛，如果在连续的𝜆𝑠个周期内未获得正的盈余，则会破产，不进入以后的epoch的模拟。


### 1.2 用户层面决策
在交易层面保证公平的选择实时最优交易策略。每个agent选择时，基于最大化自身交易盈余的原则，即最大化现实交易与选择在平台上交易的费用差。

**现实世界中的选择：<br>**
在现实世界中所知卖家的最优选择是： $argmax_{s\in S_{b,t}}u_B(q_{b.t},s_{b,t}^w)$<br>
现实世界交易的盈余表示为：
$$u_{b,t}^w=max(u_B(q_{b.t},s_{b,t}^w)-\mu_k,0)$$
$u_B(q,s)$反映匹配的质量, $s_{b,t}^w$ 表示在时间点t时，买家(b)在现实世界(w)的交易选项。

**平台上的选择：<br>**
同样的：
$$u_{b,t} = u_B(q_{b.t},s_{b,t})$$

**总体选择：<br>**
如果卖方不能提供一个正的盈余，买方将不会选择交易。
在时间t时，总体的选择，包括买家的查询，买家，卖家的交易选项用一个tuple来表示： $(q_{b,t},s_{b,t}^w,s_{p,t},s_{b,t})$

**交易盈余：<br>**
买家的盈余是： $r_{b,t}=max(u_{b,t}^w,u_{b,t}^p)$，也就是平台和现实交易盈余的最大值。<br>
卖家的盈余是：

$$
r_{s,t} =
\begin{cases}
v_s^1(1-\omega_s-P_{R,k}) & \text{for a platform transaction} \\
v_s^1(1-\omega_s) & \text{for a non-platform transaction} \\
0 & \text{otherwise}
\end{cases}
$$

**每个epoch的盈余以及平台收入：<br>**
买家的epoch盈余：一个epoch中来自于平台匹配的总盈余减去订阅平台支付的费用。<br>
卖家的epoch盈余：一个epoch中来自于平台匹配的总收入减去订阅平台支付的费用。<br>
平台的总收入：订阅费用以及推荐费的总和。<br>


### 1.3 平台层面决策
**短视查询匹配（Myopic Matching）：<br>**
短视查询匹配，使用环境中可观察到的买家以及卖家信息，将其嵌入到特征空间（latent space）中. 推荐特征空间中最接近查询的卖家，从而为买家产生最高效用。短时匹配机制将作为实验的参照标准。

**描述这一过程的POMDP(部分可观察马克洛夫环境)：**
**state：<br>**
（1）买家属性：潜在位置(latent location)、时代预算、查询分布以及对世界卖家的了解，
（2）卖家属性：潜在位置、成本比例和关闭阈值，
（3）agent的订阅状态：订阅平台与否。 用两个0，1 mask表示：$I_{B,k-1}^P$, $I_{S,k-1}^P$
（4）agent的惯性水平： $\chi_{b,k-1}$, $\chi_{s,k-1}$
（5）上一epoch的查询，卖家买家选项的序列
（6）卖家关闭状态：卖家是否在上一epoch关闭，
（7）上一epoch的订阅费用。
（8）现实交易系数 $\mu_k$

**action:<br>**
$a_k=(P_{B,k-1},P_{S,k-1},P_{R,k-1})

**state transition:<br>**
买家和（可行的）卖家遵循他们的选择模型来订阅平台（第2.4节），从而产生新的订阅状态和惯性水平。对于每个时间步长𝑡∈𝑘，我们遵循“查询、匹配、交易”动态，这给出了一个完整的序列𝑄𝑘。每个可行的卖家可以根据epoch 𝑘的剩余量和他们的关闭阈值来决定关闭。费用随采取的行动而定，世界交易摩擦根据对数正态过程演变。

**reward:<br>**
当代理订阅和交易结果可用时，奖励𝑟𝑘∼R(𝑥𝑘, 𝑎𝑘)将提供给平台。奖励可以设置为模拟不同平台目标，整合来自监管的考虑因素。
**platform observation:<br>**

平台的观察 $O_{k+1}\in\OMEGA$ 包括由平台上的买家生成的查询序列，以及他们是否通过平台进行交易的决策，


2.2 RL固定费率查询匹配
每个买家或卖家通过比较新提出的平台费用和观察到的现实交易系数下平台内外的预计剩余价值，来决定是否订阅平台。同时，决策模型将行为惯性纳入考虑，捕捉用户坚持其当前决策的倾向。
在“基于卖家盈余的匹配规则”，“基于平台利润的匹配规则”两种规则下，平台与买家和卖家之间的互动可以看作是一个斯塔克伯格博弈：平台代理是领导者，选择费用或匹配策略，买家和卖家是追随者，对平台政策做出反应。
通过这样博弈的方式，RL模型通过学习调整买家卖家的匹配政策，以最大化下一epoch中买家以及卖家的订阅量。

